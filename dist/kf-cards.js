define(["jquery","./properties","./initialproperties","./lib/js/extensionUtils","text!./lib/css/style.css"],function(a,b,c,d,e){"use strict";return d.addStyleToHeader(e),{definition:b,initialProperties:c,snapshot:{canTakeSnapshot:!0},paint:function(b,c){var d="",e=this,f=0,g=!1,h="",i=this.backendApi.getDimensionInfos().length,j=b.context.clientWidth<350?" compactLayout":"";if(h=this.backendApi.getMeasureInfos()[0].qFallbackTitle,d+="<div class='kf_cardsview"+j+"'><div class='cardslist-wrapper'><ol class='cardslist' style='list-style: none;'>",this.backendApi.eachDataRow(function(a,b){f=a;var c=i>2?b[2].qText:"",e=i>3?b[3].qText:"";d+="<li class='listitem'>",d+="<div class='card-wrapper selectable'  title='"+b[0].qText+"' data-value='"+b[0].qElemNumber+"' data-dimension='0'>",d+="<div class='rank-img-wrapper'><div class='rank-wrapper'><div class='rank'>"+(a+1)+"</div></div>",d+="<div class='img-wrapper'><img class='cover' src='"+b[1].qText+"'></div></div>",d+="<div class='attr-value-wrapper'><div class='attr-wrapper'><div class='title'>"+c+"</div>",d+="<div class='secondaryAttribute'>"+e+"</div></div>",d+="<div class='value-wrapper'><div class='mainValue'>"+b[i].qText+"</div>",d+="<div class='mainValueTitle'>"+h+"</div>",d+="</div></div></div></li>"}),this.backendApi.getRowCount()>f+1&&(d+="<li class='listitem'><button id='more' class='qui-outlinebutton' style='margin-top: 10px;'>More...</button></li>",g=!0),d+="</ol></div>",d+="</div>",b.html(d),this.selectionsEnabled){if(g){var k=[{qTop:f+1,qLeft:0,qWidth:10,qHeight:Math.min(50,this.backendApi.getRowCount()-f)}];b.find("#more").on("qv-activate",function(){e.backendApi.getData(k).then(function(){e.paint(b)})})}b.find(".selectable").on("qv-activate",function(){if(this.hasAttribute("data-value")){var a=parseInt(this.getAttribute("data-value"),10),c=parseInt(this.getAttribute("data-dimension"),10);e.selectValues(c,[a],!0),b.find("[data-dimension='"+c+"'][data-value='"+a+"']").toggleClass("selected")}}),b.find(".selectable").on("qv-swipestart",function(d){var e=a(d.originalEvent.target),f=a(d.originalEvent.target.parentElement).index();c.swipe_row_min=f,c.swipe_row_max=f;var g=parseInt(e.attr("data-value"),10);"undefined"==typeof g||g===!1||isNaN(g)||e.hasClass("selected")||(c.values_to_select.push(g),b.find("[data-dimension='0'][data-value='"+g+"']").toggleClass("selected"))}),b.find(".selectable").on("qv-swipeupdate",function(d){if(a(d.originalEvent.target.parentElement).hasClass("listitem")){var e=(a(d.originalEvent.target),a(d.originalEvent.target.parentElement.parentElement.childNodes)),f=a(d.originalEvent.target.parentElement).index(),g=c.swipe_row_min>f||c.swipe_row_max<f?!0:!1;g&&(c.swipe_row_min=c.swipe_row_min>f?f:c.swipe_row_min,c.swipe_row_max=c.swipe_row_max<f?f:c.swipe_row_max,e.slice(c.swipe_row_min,c.swipe_row_max+1).each(function(){if(!a(this).find(".card-wrapper").hasClass("selected")){var d=parseInt(a(this).find(".card-wrapper").attr("data-value"),10);"undefined"==typeof d||d===!1||isNaN(d)||(c.values_to_select.push(d),b.find("[data-dimension='0'][data-value='"+d+"']").toggleClass("selected"))}}))}}),b.find(".selectable").on("qv-swipe",function(){c.swipe_row_min=-1,c.swipe_row_max=-1,c.values_to_select!==[]&&(e.selectValues(0,c.values_to_select,!1),c.values_to_select=[])})}}}});